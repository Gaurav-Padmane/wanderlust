<% layout("layouts/boilerplate") %>

  <h3 class="mt-3">Search Results for "<%= query %>"</h3>

  <% if (!results || results.length === 0) { %>
    <p class="mt-2">No listings found.</p>
  <% } else { %>
  <div class="row search-results row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-3 g-3 mt-3">
      <% (results || []).forEach(listing => { %>
        <div class="col">
          <div class="card h-100 shadow-sm">
            <a href="/listings/<%= listing._id %>">
              <img 
                src="<%= listing.image && listing.image.url ? listing.image.url : '/images/default.jpg' %>" 
                class="card-img-top" 
                alt="Listing image"
              />
            </a>
            <div class="card-body">
              <h5 class="card-title"><%= listing.title %></h5>
              <p class="search-desc"><%= listing.description ? (listing.description.length > 60 ? listing.description.substring(0, 60) + "..." : listing.description) : "" %></p>
              <p class="text-muted"><i class="fa-solid fa-location-dot"></i> <%= listing.location %></p>
              <a href="/listings/<%= listing._id %>" class="btn btn-sm btn-outline-primary">View Details</a>
            </div>
          </div>
        </div>
      <% }) %>
    </div>
  <% } %>
